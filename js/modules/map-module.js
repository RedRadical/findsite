"use strict";

define(['require',
    'exports',
    'async!http://maps.googleapis.com/maps/api/js?sensor=true&libraries=places,weather',
    'google-map-marker-clusterer'], function (require,exports,googleMap, mapCluster) {

    var $mapCanvas;
    var imageUrl = 'http://chart.apis.google.com/chart?cht=mm&chs=24x32&chco=FFFFFF,008CFF,000000&ext=.png';
    var data = [{"lat":"31.03064","lng":"121.36441"},{"lat":"31.170168","lng":"121.423676"},{"lat":"-33.801456","lng":"151.133926"},{"lat":"31.063211","lng":"121.406624"},{"lat":"-33.769485","lng":"151.091492"},{"lat":"31.236397","lng":"121.439117"},{"lat":"-33.82531","lng":"151.087387"},{"lat":"-33.845741","lng":"151.211517"},{"lat":"31.169952","lng":"121.423218"},{"lat":"37.393833","lng":"-122.041473"},{"lat":"31.237064","lng":"121.439262"},{"lat":"31.242081","lng":"121.502335"},{"lat":"31.242062","lng":"121.502289"},{"lat":"0","lng":"0"},{"lat":"31.164524","lng":"121.49469"},{"lat":"0","lng":"0"},{"lat":"31.1696","lng":"121.423721"},{"lat":"31.1696","lng":"121.423721"},{"lat":"31.10923","lng":"121.379608"},{"lat":"-33.796116","lng":"151.14238"},{"lat":"-33.701447","lng":"151.105576"},{"lat":"-33.941063","lng":"151.057724"},{"lat":"31.169991","lng":"121.423416"},{"lat":"31.169773","lng":"121.423187"},{"lat":"-33.95187","lng":"151.081833"},{"lat":"-33.828968","lng":"151.073792"},{"lat":"31.236483","lng":"121.438965"},{"lat":"-33.884312","lng":"151.207108"},{"lat":"-33.768932","lng":"151.091522"},{"lat":"-33.704845","lng":"150.974213"},{"lat":"31.16976","lng":"121.42321"},{"lat":"-33.77597","lng":"151.102005"},{"lat":"-33.798656","lng":"151.179947"},{"lat":"-33.830879","lng":"151.084442"},{"lat":"-33.724464","lng":"150.92189"},{"lat":"-33.903797","lng":"151.21347"},{"lat":"-33.774113","lng":"151.101303"},{"lat":"-33.801445","lng":"151.134003"},{"lat":"-33.766872","lng":"151.103882"},{"lat":"-33.875397","lng":"151.026138"},{"lat":"-33.846714","lng":"151.07254"},{"lat":"-33.876774","lng":"151.207626"},{"lat":null,"lng":null},{"lat":"-33.829784","lng":"151.01506"},{"lat":"-33.913353","lng":"151.196548"},{"lat":"-37.838085","lng":"145.078583"},{"lat":"-32.146324","lng":"115.863586"},{"lat":"-37.857861","lng":"144.980804"},{"lat":"-33.951893","lng":"151.077347"},{"lat":"-33.769321","lng":"151.072845"},{"lat":"-34.92305","lng":"138.599869"},{"lat":"-33.888531","lng":"151.200409"},{"lat":"-33.872173","lng":"151.202988"},{"lat":"-33.882885","lng":"151.202286"},{"lat":"-33.920368","lng":"151.099731"},{"lat":"-37.929615","lng":"145.143845"},{"lat":"-34.922462","lng":"138.590897"},{"lat":"-33.729652","lng":"151.003448"},{"lat":"-33.796196","lng":"151.183701"},{"lat":"-27.538408","lng":"153.106949"},{"lat":"-33.825497","lng":"151.087189"},{"lat":"-33.785656","lng":"151.157959"},{"lat":"-33.705917","lng":"151.10437"},{"lat":"-27.456652","lng":"153.127563"},{"lat":"-27.494343","lng":"153.026108"},{"lat":"-33.946987","lng":"151.071655"},{"lat":"-33.922424","lng":"150.965363"},{"lat":"-33.949318","lng":"151.1203"},{"lat":"-33.932194","lng":"151.090668"},{"lat":"-33.218658","lng":"151.518173"},{"lat":"-33.97633","lng":"151.116608"},{"lat":"-33.829151","lng":"151.085602"},{"lat":"-33.920464","lng":"151.108215"},{"lat":"-33.241596","lng":"151.480835"},{"lat":"-33.931015","lng":"151.066193"},{"lat":"-27.454178","lng":"153.153519"},{"lat":"-34.096725","lng":"150.778473"},{"lat":null,"lng":null},{"lat":"-33.830578","lng":"151.075531"},{"lat":"-33.797493","lng":"150.977859"},{"lat":"-37.889576","lng":"145.101257"},{"lat":"-33.910034","lng":"151.094223"},{"lat":"-34.051479","lng":"151.016678"},{"lat":"-34.03664","lng":"151.089493"},{"lat":"-33.814941","lng":"150.972168"},{"lat":"-33.822498","lng":"150.989944"},{"lat":"-33.43362","lng":"151.444458"},{"lat":"-34.035667","lng":"150.759766"},{"lat":"-33.931324","lng":"151.064133"},{"lat":"-33.877102","lng":"151.209198"},{"lat":"-33.869507","lng":"151.209579"},{"lat":"-33.909878","lng":"150.950851"},{"lat":"-33.927902","lng":"151.081177"},{"lat":"-33.914085","lng":"151.044098"},{"lat":"-33.90815","lng":"151.209534"},{"lat":"-33.97031","lng":"151.112259"},{"lat":"-33.931812","lng":"151.135422"},{"lat":null,"lng":null},{"lat":"-34.461651","lng":"150.837982"},{"lat":"-33.786621","lng":"150.791489"},{"lat":"-33.895782","lng":"151.110138"},{"lat":"-33.861366","lng":"151.166946"},{"lat":"-33.732903","lng":"151.099396"},{"lat":null,"lng":null},{"lat":"-33.944149","lng":"150.915497"},{"lat":"-33.726833","lng":"150.781967"},{"lat":"-33.83049","lng":"150.98732"},{"lat":"-33.354153","lng":"151.48793"},{"lat":"-33.921021","lng":"151.091354"},{"lat":"-33.918671","lng":"151.076462"},{"lat":"-33.875072","lng":"151.033798"},{"lat":"-33.754787","lng":"150.994812"},{"lat":"-34.005047","lng":"151.010529"},{"lat":"-33.918953","lng":"151.056732"},{"lat":"-33.791161","lng":"151.102325"},{"lat":"-33.789459","lng":"151.078293"},{"lat":"-33.895744","lng":"151.017014"},{"lat":"-33.944622","lng":"151.196533"},{"lat":"-33.640224","lng":"151.133728"},{"lat":"-33.874271","lng":"151.206146"},{"lat":"-33.916489","lng":"151.069275"},{"lat":"-33.754257","lng":"150.920197"},{"lat":"-33.944756","lng":"150.902466"},{"lat":"-33.869205","lng":"151.188675"},{"lat":"-37.804134","lng":"145.129044"},{"lat":"-33.830673","lng":"151.165527"},{"lat":"-33.832638","lng":"151.073242"},{"lat":"-33.831131","lng":"151.213974"},{"lat":"-33.785965","lng":"151.083435"},{"lat":"-33.852371","lng":"151.046295"},{"lat":"-33.911995","lng":"151.014877"},{"lat":"-33.830948","lng":"151.20134"},{"lat":"-33.595421","lng":"150.782074"},{"lat":null,"lng":null},{"lat":"-33.861118","lng":"151.214127"},{"lat":"-34.046421","lng":"151.148636"},{"lat":"-33.784843","lng":"150.852341"},{"lat":"-33.77774","lng":"151.11644"},{"lat":"-33.767231","lng":"150.890625"},{"lat":"-33.830479","lng":"151.214661"},{"lat":"-33.811546","lng":"151.024612"},{"lat":"-33.819145","lng":"150.986053"},{"lat":"-33.924072","lng":"150.845596"},{"lat":"-33.908344","lng":"151.100235"},{"lat":"-33.806179","lng":"151.064789"},{"lat":"-33.728725","lng":"150.810028"},{"lat":"-33.888828","lng":"151.170029"},{"lat":"-33.788601","lng":"150.921143"},{"lat":"-33.637608","lng":"150.79129"},{"lat":"-33.782345","lng":"151.069519"},{"lat":"-33.858688","lng":"150.98764"},{"lat":"-27.983213","lng":"153.342346"},{"lat":"-33.954254","lng":"151.09108"},{"lat":"-33.786861","lng":"151.125122"},{"lat":"-33.836414","lng":"151.050507"},{"lat":"-37.593452","lng":"144.917984"},{"lat":"-33.892963","lng":"151.187119"},{"lat":"-33.679585","lng":"150.934738"},{"lat":"-34.041737","lng":"151.117355"},{"lat":"-33.868847","lng":"151.208374"},{"lat":"-33.883961","lng":"151.116699"},{"lat":"-30.503866","lng":"151.660614"},{"lat":"-32.964363","lng":"151.685532"},{"lat":"-34.09219","lng":"150.700104"},{"lat":"-33.86998","lng":"151.208908"},{"lat":"-33.973221","lng":"151.1147"},{"lat":"-34.001755","lng":"151.032745"},{"lat":"-33.739815","lng":"151.070602"},{"lat":"-33.896549","lng":"151.197876"},{"lat":"-33.72905","lng":"151.033585"},{"lat":"-33.951637","lng":"151.022049"},{"lat":"-33.923286","lng":"151.122849"},{"lat":"-33.810307","lng":"150.94635"},{"lat":"-33.95145","lng":"150.994781"},{"lat":"-33.951923","lng":"151.075638"},{"lat":"-33.716198","lng":"150.922958"},{"lat":"-33.764591","lng":"150.823502"},{"lat":"-33.700493","lng":"150.915863"},{"lat":"-33.800426","lng":"151.042252"},{"lat":"-33.931801","lng":"150.83725"},{"lat":"-33.775433","lng":"150.89946"},{"lat":"-33.961197","lng":"151.154297"},{"lat":"-27.484573","lng":"153.04007"},{"lat":"-34.066784","lng":"150.802322"},{"lat":"-33.784973","lng":"151.083374"},{"lat":"-33.851425","lng":"151.216599"},{"lat":"-37.743362","lng":"144.729736"},{"lat":"-37.64241","lng":"145.083466"},{"lat":"-33.807636","lng":"150.957428"},{"lat":"-33.950756","lng":"151.056229"},{"lat":"-37.63129","lng":"144.949539"},{"lat":"-33.846848","lng":"151.072922"},{"lat":"-33.854195","lng":"151.06955"},{"lat":"-32.007954","lng":"115.937096"},{"lat":"-33.961231","lng":"151.13974"},{"lat":"-33.827553","lng":"151.020203"},{"lat":"-33.754498","lng":"151.286407"},{"lat":"-33.876217","lng":"151.029388"},{"lat":"-37.720219","lng":"144.835693"},{"lat":"-33.925438","lng":"151.157867"},{"lat":"-33.81871","lng":"151.000351"},{"lat":"-33.825794","lng":"151.203735"},{"lat":"-33.801537","lng":"150.689331"},{"lat":"-33.727379","lng":"150.995789"},{"lat":"-33.718838","lng":"151.111069"},{"lat":"-34.393822","lng":"150.887344"},{"lat":"-33.819576","lng":"151.005829"},{"lat":"-33.885342","lng":"151.195953"},{"lat":"-37.858105","lng":"145.132462"},{"lat":"-33.925182","lng":"151.074387"},{"lat":"-34.029789","lng":"151.094315"},{"lat":"-33.717648","lng":"150.701065"},{"lat":"-33.902615","lng":"150.769897"},{"lat":"-33.886196","lng":"151.148178"},{"lat":"-34.053356","lng":"151.152145"},{"lat":"-33.772587","lng":"151.083344"},{"lat":"-33.896694","lng":"151.086716"},{"lat":"-33.88287","lng":"151.247406"},{"lat":"-27.470942","lng":"153.030334"},{"lat":"-34.034145","lng":"151.095688"},{"lat":"-33.875652","lng":"151.138931"},{"lat":"-34.080994","lng":"150.697845"},{"lat":"-33.708172","lng":"151.133072"},{"lat":"-33.785641","lng":"150.679199"},{"lat":"-34.301701","lng":"150.596771"},{"lat":"-33.743748","lng":"151.11377"},{"lat":null,"lng":null},{"lat":"-33.851734","lng":"150.913864"},{"lat":"-33.792229","lng":"151.104141"},{"lat":"-34.086365","lng":"150.809937"},{"lat":"-33.8592","lng":"150.897964"},{"lat":"-33.923084","lng":"151.072327"},{"lat":"-33.964985","lng":"151.131119"},{"lat":"-37.854263","lng":"145.025848"},{"lat":"-34.052795","lng":"150.827118"},{"lat":"-33.960155","lng":"151.110107"},{"lat":"-27.652279","lng":"153.111252"},{"lat":"-33.740993","lng":"150.839203"},{"lat":"-34.019306","lng":"150.856812"},{"lat":"-33.892406","lng":"150.942764"},{"lat":"-33.88945","lng":"151.12439"},{"lat":"-33.872257","lng":"150.995102"},{"lat":"-33.852428","lng":"150.99556"},{"lat":"-33.730305","lng":"151.030655"},{"lat":"-33.749836","lng":"150.735962"},{"lat":"-32.02803","lng":"115.959625"},{"lat":"-33.907478","lng":"151.210617"},{"lat":"-33.897984","lng":"151.091675"},{"lat":"-33.768326","lng":"151.124344"},{"lat":"-33.887253","lng":"151.197159"},{"lat":"-33.878277","lng":"151.099915"},{"lat":"-33.946163","lng":"151.08461"},{"lat":"-33.741776","lng":"150.924179"},{"lat":"-33.870392","lng":"150.938507"},{"lat":"-34.053539","lng":"151.101517"},{"lat":"-34.029572","lng":"150.742172"},{"lat":"-33.748539","lng":"151.28891"},{"lat":"-34.055","lng":"150.754227"},{"lat":"-33.899734","lng":"151.182999"},{"lat":"-33.914906","lng":"151.150055"},{"lat":"-34.014946","lng":"150.808853"},{"lat":"-34.078602","lng":"150.690308"},{"lat":"-27.357994","lng":"153.037369"},{"lat":"-37.96777","lng":"145.181808"},{"lat":"-33.868675","lng":"151.101715"},{"lat":"-33.875458","lng":"151.259491"},{"lat":"-33.917473","lng":"151.226974"},{"lat":"-33.842731","lng":"151.032578"},{"lat":"-34.264595","lng":"150.620071"},{"lat":"-33.721428","lng":"151.147415"},{"lat":"-33.95451","lng":"151.224838"},{"lat":"-33.765831","lng":"151.102585"},{"lat":"-33.711842","lng":"150.891495"},{"lat":"-33.759148","lng":"150.759201"},{"lat":"-33.616364","lng":"151.132904"},{"lat":"-33.871208","lng":"150.951324"},{"lat":"-33.708946","lng":"150.963165"},{"lat":"-33.823471","lng":"151.011963"},{"lat":"-33.869614","lng":"151.203751"},{"lat":"-33.772533","lng":"150.969299"},{"lat":"-33.796421","lng":"151.181946"},{"lat":"-33.827976","lng":"151.084778"},{"lat":"-33.87199","lng":"151.09314"},{"lat":"-33.99688","lng":"151.136398"},{"lat":"40.815193","lng":"-74.070168"},{"lat":"-33.794521","lng":"150.922791"},{"lat":"-35.23682","lng":"149.069672"},{"lat":"-34.037178","lng":"151.00705"},{"lat":"-33.719147","lng":"150.968246"},{"lat":"-33.940388","lng":"151.023682"},{"lat":"-33.862286","lng":"151.081696"},{"lat":"-33.813232","lng":"151.025818"},{"lat":"-33.919983","lng":"151.030029"},{"lat":"-33.754436","lng":"150.935013"},{"lat":"-33.727016","lng":"151.162491"},{"lat":"-38.070015","lng":"145.492508"},{"lat":"-33.827499","lng":"151.020477"},{"lat":"-33.826355","lng":"151.011078"},{"lat":"-37.6819","lng":"144.552795"},{"lat":"-33.902695","lng":"151.207718"},{"lat":"-33.831902","lng":"151.083633"},{"lat":"-33.866436","lng":"150.936676"},{"lat":"-33.932835","lng":"151.188889"},{"lat":"-33.939766","lng":"150.835373"},{"lat":null,"lng":null},{"lat":"-33.890232","lng":"151.110519"},{"lat":"-33.699833","lng":"150.973862"},{"lat":"-33.791924","lng":"151.081238"},{"lat":"-33.897839","lng":"151.251846"},{"lat":"-33.831402","lng":"151.010864"},{"lat":"-33.791897","lng":"150.898834"},{"lat":"-33.844906","lng":"151.066956"},{"lat":"-33.763378","lng":"150.924622"},{"lat":"-33.848755","lng":"151.086273"},{"lat":"-33.838772","lng":"151.038239"},{"lat":"-33.870949","lng":"151.102707"},{"lat":"-33.854679","lng":"150.942657"},{"lat":"-34.114502","lng":"150.79277"},{"lat":"-33.925079","lng":"151.250687"},{"lat":"-33.798702","lng":"151.186462"},{"lat":"-33.718616","lng":"150.962982"},{"lat":"-33.902893","lng":"151.189316"},{"lat":"-34.079941","lng":"150.838867"},{"lat":"-33.889874","lng":"151.240799"},{"lat":"-33.936852","lng":"151.086578"},{"lat":"-33.749569","lng":"150.740936"},{"lat":"-33.92635","lng":"151.235306"},{"lat":"-33.986374","lng":"151.097855"},{"lat":"-37.750004","lng":"145.002686"},{"lat":"-33.969643","lng":"151.124741"},{"lat":"-33.778042","lng":"151.120728"},{"lat":"-34.05011","lng":"151.122635"},{"lat":"-33.919529","lng":"150.88031"},{"lat":"-33.915848","lng":"151.036942"},{"lat":"-37.81126","lng":"144.971939"},{"lat":"-33.821117","lng":"151.007339"},{"lat":"-33.818745","lng":"151.001663"},{"lat":"-33.353951","lng":"151.488525"},{"lat":"-33.781075","lng":"150.978455"},{"lat":"-33.884769","lng":"151.200653"},{"lat":"-33.869148","lng":"151.203888"},{"lat":"-33.923477","lng":"150.916351"},{"lat":"-33.955887","lng":"151.128372"},{"lat":"-33.888218","lng":"150.902512"},{"lat":"-33.790405","lng":"151.104095"},{"lat":"-33.921661","lng":"151.203842"},{"lat":"-34.090469","lng":"150.812134"},{"lat":"-33.772152","lng":"150.833801"},{"lat":"-33.712345","lng":"151.169998"},{"lat":"-33.745708","lng":"151.285965"},{"lat":"-32.820522","lng":"151.475983"},{"lat":"-33.666271","lng":"151.117996"},{"lat":"-33.950516","lng":"151.162216"},{"lat":"-33.89579","lng":"150.984314"},{"lat":"-32.982841","lng":"151.677216"},{"lat":"-33.911022","lng":"151.118027"},{"lat":"-33.76656","lng":"150.822174"},{"lat":"-33.872711","lng":"151.121109"},{"lat":"-33.921642","lng":"150.929276"},{"lat":"-31.720366","lng":"115.789818"},{"lat":"-33.898685","lng":"151.142883"},{"lat":"-33.737194","lng":"151.054764"},{"lat":"-34.037037","lng":"150.84642"},{"lat":"-33.755898","lng":"151.211639"},{"lat":"-33.888008","lng":"151.26384"},{"lat":"-33.893192","lng":"151.230209"},{"lat":"-33.914654","lng":"151.168839"},{"lat":"-33.912628","lng":"151.048996"},{"lat":"-33.98877","lng":"150.851013"},{"lat":"-32.003593","lng":"115.953514"},{"lat":"-33.779736","lng":"151.132828"},{"lat":"-33.951744","lng":"151.245514"},{"lat":"-33.841213","lng":"151.033737"},{"lat":"-33.963898","lng":"151.120865"},{"lat":"-37.84053","lng":"144.694504"},{"lat":"-33.802677","lng":"151.084641"},{"lat":"-33.860958","lng":"150.98288"},{"lat":"-33.906013","lng":"151.23671"},{"lat":null,"lng":null},{"lat":"-37.604267","lng":"145.085144"},{"lat":"-33.9319","lng":"150.94487"},{"lat":"-37.68396","lng":"144.756424"},{"lat":"-33.913849","lng":"150.932495"},{"lat":"-34.071354","lng":"150.752243"},{"lat":"-33.90036","lng":"151.142868"},{"lat":"-33.796497","lng":"151.180359"},{"lat":"-33.837299","lng":"151.029938"},{"lat":"-33.761662","lng":"150.83139"},{"lat":"-33.803974","lng":"150.948761"},{"lat":"-37.938961","lng":"145.146042"},{"lat":"-33.896755","lng":"151.055038"},{"lat":"-33.892185","lng":"151.153503"},{"lat":"-33.757309","lng":"150.986252"},{"lat":"-33.825825","lng":"151.006393"},{"lat":"-33.768852","lng":"151.097626"},{"lat":"-33.915092","lng":"151.146515"},{"lat":"-33.98484","lng":"150.884384"},{"lat":"-33.849258","lng":"151.211411"},{"lat":"-33.776615","lng":"151.119583"},{"lat":"-33.782448","lng":"151.048157"},{"lat":"-33.796387","lng":"151.182312"},{"lat":"-33.721645","lng":"150.920685"},{"lat":"-33.796055","lng":"151.183228"},{"lat":"-33.868301","lng":"151.205933"},{"lat":"-33.844902","lng":"150.976868"},{"lat":"-34.021923","lng":"151.091812"},{"lat":"-33.833443","lng":"151.193985"},{"lat":"-33.825993","lng":"151.01149"},{"lat":"-33.774124","lng":"151.101318"},{"lat":"-37.918121","lng":"145.141953"},{"lat":"-34.014957","lng":"150.831345"},{"lat":"-33.829185","lng":"151.073425"},{"lat":"-37.952202","lng":"145.151077"},{"lat":"-33.823452","lng":"151.123169"},{"lat":"-33.773964","lng":"151.101761"},{"lat":"-33.774151","lng":"151.101532"},{"lat":"-37.573502","lng":"144.92392"},{"lat":"-33.774841","lng":"151.074387"},{"lat":"-33.941814","lng":"151.027649"},{"lat":"-33.852135","lng":"150.983551"},{"lat":"-33.890244","lng":"151.268723"},{"lat":"-33.689651","lng":"151.29451"},{"lat":"-33.911934","lng":"151.22258"},{"lat":"-33.904415","lng":"151.21196"},{"lat":"-33.826088","lng":"151.085968"},{"lat":"-33.790375","lng":"151.107712"},{"lat":"-33.791943","lng":"151.079514"},{"lat":"-33.796787","lng":"151.184052"},{"lat":"-33.951385","lng":"151.081223"},{"lat":"-33.884602","lng":"151.200684"},{"lat":"-33.920223","lng":"151.036652"},{"lat":"-33.786198","lng":"151.17067"},{"lat":"-33.920158","lng":"151.036743"},{"lat":"-33.922112","lng":"151.099838"},{"lat":"-33.915211","lng":"151.11467"},{"lat":"-33.996338","lng":"150.887863"},{"lat":"-33.789715","lng":"151.194153"},{"lat":"-38.181973","lng":"146.270111"},{"lat":"-33.731529","lng":"151.005112"},{"lat":"-33.767036","lng":"151.105835"},{"lat":"-33.860191","lng":"151.049301"},{"lat":"-33.785351","lng":"151.078629"},{"lat":"-33.755241","lng":"151.175812"},{"lat":"-33.731621","lng":"150.838135"},{"lat":"-33.878704","lng":"151.197983"},{"lat":"-33.434254","lng":"151.349396"},{"lat":"-33.862324","lng":"150.924179"},{"lat":"-33.880314","lng":"151.209808"},{"lat":"-33.764977","lng":"150.679535"},{"lat":"-33.872364","lng":"151.208847"},{"lat":"-33.915546","lng":"151.126038"},{"lat":"-33.835915","lng":"151.221176"},{"lat":"-33.915131","lng":"151.03392"},{"lat":"-33.877453","lng":"151.105057"},{"lat":"-33.825249","lng":"151.0858"},{"lat":"-33.787663","lng":"151.083435"},{"lat":"-33.794441","lng":"150.95282"},{"lat":"-33.879307","lng":"151.005005"},{"lat":"-33.892155","lng":"151.261627"},{"lat":"-34.572433","lng":"150.784622"},{"lat":"-33.889931","lng":"151.209946"},{"lat":"-33.830456","lng":"151.087585"},{"lat":"-33.934948","lng":"151.146576"},{"lat":"-33.787991","lng":"151.251251"},{"lat":"-33.651871","lng":"150.945435"},{"lat":"-34.071712","lng":"150.822128"},{"lat":"-33.720459","lng":"150.725464"},{"lat":"-33.885788","lng":"151.255875"},{"lat":"-33.881138","lng":"151.196869"},{"lat":"-33.870949","lng":"150.955887"},{"lat":"-33.926991","lng":"151.232697"},{"lat":"-33.77573","lng":"151.112213"},{"lat":"-33.934986","lng":"151.156631"},{"lat":"-33.785946","lng":"150.89447"},{"lat":"-33.83189","lng":"151.0867"},{"lat":"-33.671627","lng":"151.097031"},{"lat":"-33.904671","lng":"151.064362"},{"lat":"-33.802441","lng":"151.004974"},{"lat":"-33.775681","lng":"150.713257"},{"lat":"-33.913345","lng":"151.115936"},{"lat":"-33.813602","lng":"151.184204"},{"lat":"-33.891033","lng":"151.205002"},{"lat":"-33.921177","lng":"151.069031"},{"lat":"-33.793018","lng":"150.995438"},{"lat":"-33.873714","lng":"151.195847"},{"lat":"-33.749306","lng":"150.824661"},{"lat":"-27.590679","lng":"153.09903"},{"lat":"-33.76767","lng":"151.16188"},{"lat":"-33.909508","lng":"151.101166"},{"lat":"-33.735977","lng":"151.000702"},{"lat":"-33.751171","lng":"151.288437"},{"lat":"-33.756981","lng":"150.812469"},{"lat":"-33.820812","lng":"150.963837"},{"lat":"-33.787373","lng":"151.083679"},{"lat":"-33.674088","lng":"150.86763"},{"lat":"-33.907017","lng":"151.137238"},{"lat":"-33.836639","lng":"151.013535"},{"lat":"-33.822998","lng":"150.998672"},{"lat":"-33.857346","lng":"151.279053"},{"lat":"-33.875328","lng":"151.207901"},{"lat":"-33.777431","lng":"151.118286"},{"lat":"-33.895275","lng":"150.874924"},{"lat":"-33.884918","lng":"150.846817"},{"lat":"-33.970493","lng":"151.020874"},{"lat":"-33.846066","lng":"151.21312"},{"lat":"-33.954437","lng":"151.2276"},{"lat":"-33.808556","lng":"151.088608"},{"lat":"-33.737335","lng":"150.923096"},{"lat":"-33.87569","lng":"151.102249"},{"lat":"-33.85083","lng":"151.158539"},{"lat":"-33.819622","lng":"150.999268"},{"lat":"-33.924675","lng":"151.070999"},{"lat":"-33.871338","lng":"151.197281"},{"lat":"-33.438549","lng":"151.404236"},{"lat":"-33.783318","lng":"151.136307"},{"lat":"-33.876038","lng":"151.221573"},{"lat":"-33.907784","lng":"151.156952"},{"lat":"-33.892994","lng":"150.898132"},{"lat":"-33.931408","lng":"151.179581"},{"lat":"-33.932991","lng":"150.843918"},{"lat":"-33.803623","lng":"150.956055"},{"lat":"-33.875626","lng":"151.197754"},{"lat":"-33.806419","lng":"151.090256"},{"lat":"-33.901508","lng":"151.195602"},{"lat":"-37.668709","lng":"144.61763"},{"lat":"-33.703171","lng":"151.100571"},{"lat":null,"lng":null},{"lat":"-33.821167","lng":"150.96402"},{"lat":"-33.700157","lng":"150.922043"},{"lat":"-33.844097","lng":"151.039917"},{"lat":"-33.894341","lng":"151.066025"},{"lat":"-33.614086","lng":"150.839142"},{"lat":"-37.959278","lng":"145.14209"},{"lat":"-33.898117","lng":"151.186462"},{"lat":"-33.939468","lng":"151.051132"},{"lat":"-37.738342","lng":"144.767517"},{"lat":"-33.75444","lng":"151.248428"},{"lat":"-33.965965","lng":"151.103851"},{"lat":"-34.08112","lng":"150.80925"},{"lat":"-33.869194","lng":"151.101212"},{"lat":"-33.793365","lng":"151.150681"},{"lat":"-33.76836","lng":"151.080124"},{"lat":"-33.916389","lng":"151.111847"},{"lat":"-33.764286","lng":"150.943954"},{"lat":"-33.889278","lng":"151.194321"},{"lat":"-33.954807","lng":"150.881287"},{"lat":"-33.963783","lng":"151.012192"},{"lat":"-33.891659","lng":"151.201096"},{"lat":"-33.846359","lng":"150.851074"},{"lat":"-33.858353","lng":"150.998642"},{"lat":"-33.813892","lng":"151.009048"},{"lat":"-33.596111","lng":"150.766724"},{"lat":"-33.915421","lng":"150.839462"},{"lat":"-33.831245","lng":"151.239151"},{"lat":"-33.942471","lng":"151.126984"},{"lat":"-33.904423","lng":"150.910141"},{"lat":"-32.876995","lng":"151.652802"},{"lat":"-33.896873","lng":"151.211487"},{"lat":"-34.064156","lng":"150.83136"},{"lat":"-33.971455","lng":"151.079315"},{"lat":"-33.931625","lng":"151.099014"},{"lat":"-33.705341","lng":"151.278717"},{"lat":"-33.988739","lng":"151.139267"},{"lat":"-33.872295","lng":"150.940048"},{"lat":"-33.889565","lng":"150.900009"},{"lat":"-33.704525","lng":"151.294708"},{"lat":"-33.701252","lng":"150.937408"},{"lat":"-33.985279","lng":"150.899124"},{"lat":"-33.869507","lng":"150.948578"},{"lat":null,"lng":null},{"lat":"-33.786263","lng":"150.942154"},{"lat":"-33.871635","lng":"151.216339"},{"lat":"-33.949314","lng":"151.243866"},{"lat":"-37.850685","lng":"145.115479"},{"lat":"-34.106087","lng":"150.789169"},{"lat":"-33.786129","lng":"151.039429"},{"lat":"-33.746166","lng":"150.907883"},{"lat":"-33.874859","lng":"151.089035"},{"lat":"-33.878361","lng":"151.221252"},{"lat":"-33.810131","lng":"151.113556"},{"lat":"-33.874157","lng":"151.067291"},{"lat":"-33.86998","lng":"151.268814"},{"lat":"-33.787926","lng":"151.073547"},{"lat":"-33.85376","lng":"150.962952"},{"lat":"-33.874905","lng":"150.967743"},{"lat":"-33.899349","lng":"151.109421"},{"lat":"-33.903366","lng":"151.063049"},{"lat":"-33.96854","lng":"151.104126"},{"lat":"-34.01696","lng":"150.829803"},{"lat":"-33.872318","lng":"151.208237"},{"lat":null,"lng":null},{"lat":"-37.81279","lng":"145.276962"},{"lat":"-33.716938","lng":"150.902145"},{"lat":"31.133577","lng":"121.405159"},{"lat":"31.169916","lng":"121.423363"},{"lat":"-33.778023","lng":"151.048325"},{"lat":"-33.841389","lng":"151.207321"},{"lat":"-33.966717","lng":"151.107361"}];
    var markers = [];
    var map = null;
    var styles = [{
        url: '/images/markers.png',
        height: 44,
        width: 28,
        anchor: [6, 0],
        textColor: '#fff',
        textSize: 11,
        backgroundPosition: '-11px -112px'
    }, {
        url: '/images/markers.png',
        height: 61,
        width: 36,
        anchor: [12, 0],
        textColor: '#fff',
        textSize: 12,
        backgroundPosition: '-5px -63px'
    }, {
        url: '/images/markers.png',
        height: 78,
        width: 47,
        anchor: [14, 0],
        textColor: '#fff',
        textSize: 14,
        backgroundPosition: '0 0'
    }];

    function init(canvas){
        $mapCanvas = canvas;
        resize();
        $(window).on('resize', function(){
            resize();
        });

        var mapOptions = {
            disableDoubleClickZoom: true,
            disableDefaultUI: true,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.DEFAULT,
                position: google.maps.ControlPosition.RIGHT_CENTER
            },
            center: new google.maps.LatLng(-33.813470, 150.889474),
            zoom: 11,
            maxZoom: 14
        };
        map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

        addMarkers();
    }

    function addMarkers(){
        for (var i = 0; i < data.length; ++i) {
            var latLng = new google.maps.LatLng(data[i].lat, data[i].lng)
            var marker = new google.maps.Marker({
                position: latLng,
                customData: {
                    title: 'ABC'
                }
            });
            markers.push(marker);
        }

        var markerClusterer = new MarkerClusterer(map, markers, {
            styles: styles,
            minimumClusterSize:1,
            zoomOnClick: false
        });

        google.maps.event.addListener(markerClusterer, 'clusterclick', function(cluster){
            var zoomLevel = map.getZoom();
            if(zoomLevel < 13){
                map.fitBounds(cluster.getBounds());
            }else{
                var myMarkers = cluster.getMarkers();
                for(var i = 0; i < myMarkers.length; i++){
                    var marker = myMarkers[i];
                    console.log(marker.customData);
                }
            }
        });
    }

    function resize(){
        var mapHeight = $(window).height() - $('header').height() - $('footer').height() - 50;
        $mapCanvas.height(mapHeight);
    }

    exports.init = init;
});